%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Journal Article
% LaTeX Template
% Version 1.4 (15/5/16)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% Original author:
% Frits Wenneker (http://www.howtotex.com) with extensive modifications by
% Vel (vel@LaTeXTemplates.com)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[twoside,twocolumn,paper=letter]{article}
\usepackage[cm]{fullpage} 

\usepackage{blindtext} % Package to generate dummy text throughout this template 

\usepackage[sc]{mathpazo} % Use the Palatino font
\usepackage[T1]{fontenc} % Use 8-bit encoding that has 256 glyphs
\linespread{1.05} % Line spacing - Palatino needs more space between lines
\setlength\parindent{0pt}
\usepackage[protrusion=true,expansion=true]{microtype} % Slightly tweak font spacing for aesthetics

\usepackage[english]{babel} % Language hyphenation and typographical rules

%\usepackage[hmarginratio=1:1,top=32mm,columnsep=20pt]{geometry} % Document margins
\usepackage[hang, small,labelfont=bf,up,textfont=it,up]{caption} % Custom captions under/above floats in tables or figures
\usepackage{booktabs} % Horizontal rules in tables

\usepackage{lettrine} % The lettrine is the first enlarged letter at the beginning of the text

\usepackage{enumitem} % Customized lists
\setlist[itemize]{noitemsep} % Make itemize lists more compact

\usepackage{abstract} % Allows abstract customization
\renewcommand{\abstractnamefont}{\normalfont\bfseries} % Set the "Abstract" text to bold
\renewcommand{\abstracttextfont}{\normalfont\small\itshape} % Set the abstract itself to small italic text

\usepackage{titlesec} % Allows customization of titles
\renewcommand\thesection{\Roman{section}} % Roman numerals for the sections
\renewcommand\thesubsection{\roman{subsection}} % roman numerals for subsections
\titleformat{\section}[block]{\large\scshape\centering}{\thesection.}{1em}{} % Change the look of the section titles
\titleformat{\subsection}[block]{\large}{\thesubsection.}{1em}{} % Change the look of the section titles

\usepackage{fancyhdr} % Headers and footers
\pagestyle{fancy} % All pages have headers and footers
\fancyhead{} % Blank out the default header
\fancyfoot{} % Blank out the default footer
%\fancyhead[C]{Running title $\bullet$ May 2016 $\bullet$ Vol. XXI, No. 1} % Custom header text
\fancyfoot[RO,LE]{\thepage} % Custom footer text

\usepackage{titling} % Customizing the title section

\usepackage{hyperref} % For hyperlinks in the PDF
\usepackage{graphicx} % Including graphics
\usepackage{subcaption} % Including subfigures
\usepackage{stfloats} 
%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\setlength{\droptitle}{-4\baselineskip} % Move the title up

\pretitle{\begin{center}\Large\bfseries} % Article title formatting
\posttitle{\end{center}} % Article title closing formatting
\title{Applying Machine Learning to Predict and Explain Primate Consortship} % Article title
\author{%
\textsc{Josh King} \\[1ex] 
\and 
\textsc{Vayu Kishore} \\[1ex] 
\and 
\textsc{Filippo Ranalli} \\[1ex] 
}
\date{} % Leave empty to omit a date
\renewcommand{\maketitlehookd}{%
%\begin{abstract}
%\noindent \blindtext % Dummy abstract text - replace \blindtext with your abstract text
%\end{abstract}
}

%----------------------------------------------------------------------------------------

\begin{document}

% Print the title
\maketitle

%----------------------------------------------------------------------------------------
%	ARTICLE CONTENTS
%----------------------------------------------------------------------------------------

\section{Introduction}

\lettrine[nindent=0em,lines=3]{T} he mating behavior of a species drives genetic
interchange and is a major driver of evolution within populations. Factors that
contribute to consortship may range from genetic causes, such as physical traits
expressed due to the presence of a gene, to those that are social or behavioral.
The contribution of social factors is of particular interest for animals that
live in structured groups, where factors such as rank within a social heirarchy
may impact mating success.  Investigating this topic will provide deeper insight
into the factors of mating success in social mammals, which may be extended to
apply to humans as well.\\

We apply machine learning methods to investigate the behavioral and genetic
reasons for success and failure of mating between wild baboon pairs. Our
analysis applies machine learning methods to examine whether successful
consortships can be predicted, and whether certain behavioral or genetic
features are especially relevant in determining consortship. Additionally, we
investigate whether successful and unsuccessful pairs can be clustered, and
whether there are certain clusters present in one group that are not present in
the other.

%------------------------------------------------

\section{Related Work}

\cite{Tung:2012} examine the impact of behavioral and genetic effects on
consortship in male/female baboon pairs in a wild yellow baboon population. They
found that a mix of both genetic and social factors drive non-random mating
within populations.

\section{Dataset}
The dataset that we use was collected and analyzed using statistical methods by
\cite{Tung:2012}. It contains observations about the success of potential baboon
mating pairs. In particular, it specifies if , male/female baboon pairings were
successful in consorting when given the opportunity.  There are approximately
12,000 observations, and the features are a mix of behavioral data such as the
rank difference between the male and female pair, as well as genetic data, such
as the estimated genetic distance between the pair. 
\subsection{Features}
There are several categories of features present within the dataset.
\begin{itemize}
  \item{\textbf{Observed biological and genetic features}: These include female age
    and conceptiveness, as well as the estimated genetic diversity and genetic
    distance between the mating pair.}
  \item{\textbf{Observed behavioral features}: These include rank of the mating pair
    within the social heirarchy of the group and how many males and females from
    their group were present when the interaction of the pair took place.}
  \item{\textbf{Derived Pairwise Features}: Some features are
    transformations applied to the observed features described above, which were
    computed by \cite{Tung:2012}. Some of the transformations compute a pairwise
    score based on a combination of the male and female attributes. For example,
    the rank\_interact feature represents the combination of male and female
    ranks.
    }
  \item{\textbf{Derived Single Features}: The remaining features are single
    raw features which are scaled based on an assumed distribution.  The
    male\_rank\_transform feature, for example, scales the male rank based on an
    exponential distribution.}
\end{itemize}

In addition to the different categories, some of the features, such as
(untransformed) rank, are ordinal, while others, such as estimated genetic
distance are real-valued.

\subsection{Identifiers and Labels}
Each datapoint contains an identifier of the male and female pair in an
interaction that could lead to a consortship and a 0/1 label which indicates
whether the male and female consorted.

\section{Preprocessing}

In the analysis that we have conducted up to this point, we have not performed
any preprocessing on the data. We may consider applying additional
transformations to the features, such as whitening using PCA if we find that our
models are negatively impacted by the colinearity between features.

\section{Methods}
\subsection{Materials}

To perform our analysis, we used the \texttt{scikit-learn} python package. Methods
that were not readily available in \texttt{scikit-learn}, such as feature selection, were
implemented independently in python.


\subsection{Classification}
% feature selection
% algos and cross-validation
\subsection{Clustering}
% kmeans on non-consort pairs, examined centroids, used PCA to visualize

We ran the k-means algorithm with 4 clusters on the consorting and
non-consorting pairs. To visualize the clusters, we then used dimensionality
reduction techniques such as PCA and t-SNE manifold tool.\\

We also examined using affinity propagation which can automatically determine
the number of clusters.

\subsection{Graphical Approach}

%------------------------------------------------

\section{Results and Discussion}
\subsection{Exploratory Data Analysis}
% labels imbalanced
Notably, we observe that the labels within the dataset are imbalanced -- there
are approximately ten times as many pairs which did not consort than those who
did. This imbalance may cause an issue in our classification algorithms since .
To avoid this we use the \texttt{weight} for \texttt{scikit-learn}'s classifiers
to automatically assign weights to the classes based on the incidence of
labels.\\
% PCA results
\begin{figure}
      \centering
          \includegraphics[width=0.5\textwidth]{../figs/consort_non_consort_visualization_pca.png}
  \caption{Reduced-dimensionality PCA visualization of consorting (red) and
  non-consorting pairs (green)}
  \label{fig:pca_vis}
\end{figure}
Using PCA to map higher dimensional dataset to 2 dimensions does not reveal
any lower-dimensional separation between the consorting/non-consorting pairs, as
shown in Figure \ref{fig:pca_vis}.
This indicates that the classification problem may be inherently
high-dimensional. The tSNE manifold mapping indicates this as well.
\subsection{Classification}
% confusion matrix
\subsection{Clustering}
% kmeans graphic
\begin{figure}[h]
      \centering
          \includegraphics[width=0.5\textwidth]{../figs/non_consort_kmeans_2d_tsne.png}
  \caption{t-SNE visualization of K-Means with 4 clusters applied on consorting
  and non-consorting pairs.}
  \label{fig:non_consort_clustering_vis}
\end{figure}
Based on the centroids of the non-consorting clusters, non-consorting pairs can
be divided into:
\begin{itemize}
  \item{TODO: describe clusters}
\end{itemize}
\begin{figure}[h]
      \centering
          \includegraphics[width=0.5\textwidth]{../figs/consort_kmeans_2d_tsne.png}
  \caption{t-SNE visualization of K-Means with 4 clusters applied on consorting
  and consorting pairs.}
  \label{fig:consort_clustering_vis}
\end{figure}
Additionally, the centroids of the consorting clusters indicate that consorting
pairs can be clustered into:
\begin{itemize}
  \item{TODO: describe clusters}
\end{itemize}

The lower-dimensional visualization of these clusters shows cleaner separation
for the consorting pairs (Figure \ref{fig:consort_clustering_vis}) than for the
non-consorting pairs (Figure \ref{fig:non_consort_clustering_vis}).

Our initial experimentation with affinity propagation led the number of
automatically determined clusters resulted in over 64 clusters, which is too
high for us to interpret reasonably.

\subsection{Graphical Approach}

%------------------------------------------------

\section{Next Steps}

The analysis that we have performed until now used the features directly from
the original dataset. We plan to examine if appyling additional preprocessing to
the data, such as normalizing ages or applying whitening to the derived features
can improve our algorithms.\\

Additionally, we plan to continue investigating clustering methods. Since we
cannot easily pick out clusters from lower dimensional representations of the
data, we are especially interested in exploring methods that can automatically
determine the number of clusters within our data, without creating an excessive
number of clusters.

%----------------------------------------------------------------------------------------
%	REFERENCE LIST
%----------------------------------------------------------------------------------------

\begin{thebibliography}{99} % Bibliography - this is intentionally simple in this template

\bibitem[Tung et al., 2012]{Tung:2012}
  Jenny Tung, Marie J. E. Charpentier, Sayan Mukherjee, Jeanne Altmann, and Susan C. Alberts (2012)
\newblock 
  Genetic Effects on Mating Success and Partner Choice in a Social Mammal.
\newblock {\em The American Naturalist}, 2012 180:1, 113--129.
 
\end{thebibliography}

%----------------------------------------------------------------------------------------

\end{document}
